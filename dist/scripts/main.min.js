/*!
 *
 *  Web Starter Kit
 *  Copyright 2014 Google Inc. All rights reserved.
 *
 *  Licensed under the Apache License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License
 *
 */
!function(){"use strict";function t(){n.classList.remove("open"),r.classList.remove("open"),o.classList.remove("open")}function e(){n.classList.toggle("open"),r.classList.toggle("open"),o.classList.toggle("open"),o.classList.add("opened")}var c=document.querySelector.bind(document),o=c(".navdrawer-container"),n=document.body,r=c(".app-bar"),i=c(".menu"),a=c("main");a.addEventListener("click",t),i.addEventListener("click",e),o.addEventListener("click",function(e){("A"===e.target.nodeName||"LI"===e.target.nodeName)&&t()})}();var app=angular.module("shop",["ngRoute"]);app.directive("scalable",function(){"use strict";return{link:function(t,e){e.bind("load",function(){var t=e[0].naturalWidth,c=e[0].naturalHeight,o=e.parent()[0].clientWidth,n=e.parent()[0].clientHeight,r=t*n/c;console.log([t,c,o,n,r]),t>o&&c>n&&e.addClass(r>o?"cropWidth":"cropHeight")})}}}),app.directive("hoverlift",function(){"use strict";return{link:function(t,e){e.bind("mouseenter",function(){e.find("paper-shadow").attr("z","1")}),e.bind("mouseleave",function(){e.find("paper-shadow").attr("z","0")})}}}),app.run(["$http",function(t){"use strict";t.defaults.headers.common["Accept-Encodings"]="json"}]),app.filter("charges",function(){"use strict";return function(t){return"percentage"===t.kind?t.price.toString()+"%":"â‚¹"+t.price.toString()}}),app.service("Requests",["$http",function(t){"use strict";this.get=function(e,c,o){t.get(e,{params:c}).success(o)},this.post=function(e,c,o){t.post(e,c).success(o)}}]),app.controller("HomeCtrl",["$scope","$rootScope","Requests",function(t,e,c){"use strict";t.categories=[],t.active={category:null,view:"list",loading:!1},c.get("/general_details",{merchant:e.merchant.id},function(e){t.merchant=e,angular.forEach(e.categories,function(t){this.push(t[0])},t.categories)}),t.categoryList=function(t){e.$broadcast("categorySet",{category:t})}}]),app.controller("CtgCtrl",["$scope","$rootScope","Requests",function(t,e,c){"use strict";t.refreshProductList=function(o){t.active.loading=!0,t.active.category===o?(t.active.view="list",document.body.scrollTop=document.documentElement.scrollTop=0,t.active.loading=!1):c.get("/category/"+o,{merchant:e.merchant.id},function(e){t.productList=e.products,t.active.category=o,t.active.view="list",document.body.scrollTop=document.documentElement.scrollTop=0,t.active.loading=!1})},null===t.active.category&&t.refreshProductList("Featured"),t.$on("categorySet",function(e,c){t.refreshProductList(c.category)}),t.showProduct=function(t){e.$broadcast("productSet",{product:t})}}]),app.controller("PdtCtrl",["$scope","$rootScope","Requests",function(t,e,c){"use strict";t.$on("productSet",function(e,c){t.product=c.product,t.isPurchasable=c.product.units_available>0&&c.product.unit_price>0,t.active.view="product",document.body.scrollTop=document.documentElement.scrollTop=0}),t.addCart=function(){t.active.loading=!0,c.post("/cart/",{product_id:t.product.id,merchant:e.merchant.id},function(c){t.cart=c,e.cartId=c.cart_id,e.cartItemCount=c.cart_item_count,e.goToCart(),t.active.loading=!1})}}]);