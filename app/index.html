<!doctype html>
<html lang="">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="A front-end template that helps you build fast, modern mobile web apps.">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>${c.merchant.name}</title>

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="icon" sizes="192x192" href="images/touch/chrome-touch-icon-192x192.png">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Web Starter Kit">
    <link rel="apple-touch-icon-precomposed" href="apple-touch-icon-precomposed.png">

    <!-- Tile icon for Win8 (144x144 + tile color) -->
    <meta name="msapplication-TileImage" content="images/touch/ms-touch-icon-144x144-precomposed.png">
    <meta name="msapplication-TileColor" content="#3372DF">

    <!-- SEO: If your mobile URL is different from the desktop URL, add a canonical link to the desktop page https://developers.google.com/webmasters/smartphone-sites/feature-phones -->
    <!--
    <link rel="canonical" href="http://www.example.com/">
    -->

    <!-- Page styles -->
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/purejs.css">
</head>
<body ng-app="shop" ng-controller="HomeCtrl" style="overflow: hidden;">
<div id="fb-root"></div>
<header class="app-bar promote-layer ng-cloak" ng-cloak ng-class="{hidden: is_fb_store}">
    <div class="app-bar-container">
        <button class="menu"><img src="images/hamburger.svg" alt="Menu"></button>
        <h1 class="logo">
            <a href="/" style="text-decoration: none !important;">
                <div ng-if="merchant.logo">
                    <img ng-src="{{ merchant.logo }}" title="{{ merchant.name }}" style="max-height: 65%;"/>
                </div>
                <div ng-if="!merchant.logo">
                    {{ merchant.name }}
                </div>
            </a>
        </h1>
        <section class="app-bar-actions">
            <!-- Put App Bar Buttons Here -->

        </section>
    </div>
</header>

<nav class="navdrawer-container promote-layer ng-cloak" ng-cloak>
    <h4>Navigation</h4>
    <ul>
        <li ng-class="{active: activeCategory == 'Featured'}"><a href="#" ng-click="categoryList('Featured')">Featured</a></li>
        <li ng-repeat="cat in categories | filter:'!Featured'" ng-class="{active: activeCategory == cat}">
            <a href="#" ng-click="categoryList(cat)">{{cat}}</a>
        </li>
        <li style="position:absolute; right:2%;">
            <div class="notify_container">
                <a href="#" title="Shopping Cart" ng-click="go_to_cart();"> <i style="vertical-align: middle;" class="icomoon-cart"></i></a>
                <div class="notify_bubble" ng-class="{hidden: cart_item_count <= 0}">${c.cart_item_count}</div>
            </div>
        </li>
    </ul>
</nav>

<main class="ng-cloak" ng-cloak>
    <div id="products_list" class="pure-g" ng-controller="CtgCtrl">
        <div class="pure-u-1 pure-u-sm-1-2 pure-u-md-1-3 pure-u-lg-1-4 pure-u-xl-1-4" ng-repeat="product in productList">
            <div class="product thumbnail" style="padding:2em 2em 1.5em; margin-bottom:0.5em;">
                <a class="product_link" href="#" ng-click="showProduct(product)" style="text-decoration: none !important;">
                    <div class="image_detail">
                        <img class="pure-img" ng-src="{{ product.photo[0][2] }}"/>
                    </div>
                    <div class="details">
                        <div class="name small color--text">
                            {{product.name}}
                        </div>
                        <div style="text-align: right; padding-top:0.8em;">
                            <span class="color--remember base" ng-if="!product.unit_price">
                                <small></small>Enquire
                            </span>
                            <span class="color--highlight medium" ng-if="product.unit_price">
                                <span class="color--danger" style="font-size:0.7em;" ng-if="product.mrp"><strike><small>&#8377;</small> {{product.mrp}}</strike></span>
                                 <small>&#8377;</small> {{product.unit_price}}
                            </span>
                        </div>
                    </div>
                </a>
            </div>
        </div>
    </div>

    <div id="product_board" class="pure-g" ng-controller="PdtCtrl" hidden style="padding:2em 0;">
        <div class="pure-u-1 pure-u-sm-1-3 pure-u-md-1-3 pure-u-lg-2-5 pure-u-xl-2-5 centered">
            <img class="pure-img" ng-src="{{ product.photo[0][1] }}" ng-if="product.photo[0]">
            <br/>
            <div class="small color--remember" style="text-align: left;">Browse Other Products In:</div>
            <ul class="small color--learning" style="text-align: left; padding:0;">
                <li ng-repeat="category in product.categories"> <a class="color--learning" href="#" ng-click="categoryList(category)">{{category}}</a></li>
            </ul>
        </div>
        <div class="pure-u-1 pure-u-sm-2-3 pure-u-md-2-3 pure-u-lg-3-5 pure-u-xl-3-5" style="padding-left:2.5em">
            <div class="large">{{product.name}}</div>
            <p ng-if="product.units_available > 0" class="color--user" style="margin-top:0; padding-left:5px;">In Stock</p>
            <p ng-if="product.units_available <= 0" class="color--danger" style="margin-top:0; padding-left:5px;">Out Of Stock</p>

            <br/>
            <div ng-if="is_purchasable">
                <div class="pure-g">
                    <div class="pure-u-1-2 pure-u-md-1-3 pure-u-lg-1-4" style="padding:12px 5px; margin: 13px 0;">
                        <span class="color--highlight medium">
                            <span class="color--danger" style="font-size:0.7em;" ng-if="product.mrp"><strike><small>&#8377;</small> {{product.mrp}}</strike></span>
                            <span style="width:60px;"></span>
                            <small>&#8377;</small> {{product.unit_price}}
                        </span>
                    </div>
                    <div class="pure-u-1-2 pure-u-md-2-3 pure-u-lg-3-4">
                        <button class="button--primary base" ng-click="addCart()"> <i class="icomoon-cart"> </i> Add to Cart</button>
                        <div class="color--remember base" style="padding-top: 0;">
                            <!--<small>Free shipping available if total purchase amount is more than <span style="white-space: nowrap;"> <small>&#8377;</small> 1000</span></small>-->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<footer class="main-footer">
    <div class="main-footer__container clear">
        <div class="large centered color--muted" style="padding-top: 0;">About <strong>${c.merchant.name.title()}</strong></div>
        <div class="pure-g main-footer__list-group">
            <div class="pure-u-1 pure-u-sm-1-3 pure-u-md-1-4" style="text-align: right">
                <ul class="main-footer__list">
                    <li><a href="/privacy_policy">Privacy Policy</a></li>
                    <li><a href="/terms_of_use">Terms of Use</a></li>
                    <li><a href="/delivery">Delivery</a></li>
                    <li><a href="/cancellations_and_returns">Cancellations and Returns</a></li>
                    <li><a href="/refunds">Refunds</a></li>
                    <li><a href="/disclaimer">Disclaimer</a></li>
                </ul>
            </div>
            <div  id="footer_about" class="pure-u-1 pure-u-sm-1-3 pure-u-md-1-2">
                <div style="text-align: justify; padding:0 2em;"><p class="small" style="color: #ccc;">${c.merchant.description}</p></div>
            </div>
            <div class="pure-u-1 pure-u-sm-1-3 pure-u-md-1-4 main-footer__contacts">
                <div><strong>${c.merchant.name.title()}</strong></div>
                <div>${c.org.registered_address.street}</div>
                <div>${c.org.registered_address.city} - ${c.org.registered_address.pincode}</div>
                <div>+91 ${c.org.registered_address.phone}</div>
            </div>
        </div>
    </div>
</footer>
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.25/angular.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.25/angular-route.js"></script>

<!-- build:js scripts/main.min.js -->
<script src="scripts/main.js"></script>
<!-- endbuild -->

<script>
    app.provider('KyashConstants', function () {
        // default values
        var values = {
            merchant: {
                id: '${c.merchant.key.id()}',
                short_code: '${c.merchant.short_code}',
                custom_domain: '${c.merchant.custom_domain or ""}'
            },
            is_fb_store: ${'true' if c.is_fb_store else 'false'},
            cart_item_count: ${c.cart_item_count},
            cart_id: '${c.cart_order.key.id() if c.cart_order else ""}'
        };
        return {
            $get: function () {
                return values;
            }
        };
    }).run(function ($rootScope, KyashConstants) {
        $rootScope.merchant = KyashConstants.merchant;
        $rootScope.is_fb_store = KyashConstants.is_fb_store;
        $rootScope.cart_item_count = KyashConstants.cart_item_count;
        $rootScope.cart_id = KyashConstants.cart_id;

        if($rootScope.is_fb_store) {
            window.fbAsyncInit = function() {
                FB.init({
                    appId   : '${config.FB_APP_ID}', //Your facebook APP here
                    cookie  : false,
                    version : 'v2.1'
                });
            };

            window.onload = function() {
                FB.Canvas.setAutoGrow(100);
            };

            (function(d, s, id) {
                var js, fjs = d.getElementsByTagName(s)[0];
                if (d.getElementById(id)) return;
                js = d.createElement(s); js.id = id;
                js.src = "//connect.facebook.net/en_US/sdk.js";
                fjs.parentNode.insertBefore(js, fjs);
            }(document, 'script', 'facebook-jssdk'));
        }

        $rootScope.go_to_cart = function() {
            var url = 'http://';
            if ($rootScope.merchant.custom_domain.trim() != '') {
                url += $rootScope.merchant.custom_domain.trim() + '/';
            }
            else {
                url += $rootScope.merchant.short_code.trim() + '.kyash.com/';
            }
            url += 'cart/?cart_id=' + $rootScope.cart_id;

            console.log(url, $rootScope.is_fb_store);
            if($rootScope.is_fb_store) {
                console.log('Opening new window.');
                window.open(url);
            }
            else {
                window.location = url;
            }
        }
    });
</script>

<!-- Built with love using Web Starter Kit -->
</body>
</html>